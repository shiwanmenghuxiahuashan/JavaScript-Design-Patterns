# 观察者模式

## 说明

1. 一个图文并茂的设计模式在线网站，支持typescript代码示例，思想是相通的

    [设计模式-Refactoring.Guru](https://refactoringguru.cn/design-patterns)

2. Addy Osmani 的《Javascript 设计模式》在线英文原版。有能力的还是看原版吧。纸质书好多翻译问题和示例代码错误问题

    [《JavaScript Design Patterns》Addy Osmani  The Observer Pattern ](https://addyosmani.com/resources/essentialjsdesignpatterns/book/#observerpatternjavascript)

 以下内容为**Addy Osmani**的《**JavaScript Design Patterns**》中观察者模式的中文意译，翻译的有问题的地方多指教。其中引用部分为原文，可放心阅读。

## 正文

> The Observer is a design pattern where an object (known as a subject) maintains a list of objects depending on it (observers), automatically notifying them of any changes to state.

Observer 是一种设计模式，其中一个被称为**观察主体**的对象，维护着一个依赖于它的**观察者列表**，并自动的将任何状态的更改通知给**观察者们**。

> When a subject needs to notify observers about something interesting happening, it broadcasts a notification to the observers (which can include specific data related to the topic of the notification).

当**观察主体**需要将一些有趣的事情通知**观察者们**时，**观察主体**会广播通知**观察者们**（可以包括与通知**观察主体**相关的特定数据）。

> When we no longer wish for a particular observer to be notified of changes by the subject they are registered with, the subject can remove them from the list of observers.

当我们希望某个特定的**观察者**不再收到**观察主体**发出的有关更改的通知时，**观察主体**可以将其从**观察者列表**中删除。

> It's often useful to refer back to published definitions of design patterns that are language agnostic to get a broader sense of their usage and advantages over time. The definition of the Observer pattern provided in the GoF book, Design Patterns: Elements of Reusable Object-Oriented Software, is:
>
> *"One or more observers are interested in the state of a subject and register their interest with the subject by attaching themselves. When something changes in our subject that the observer may be interested in, a notify message is sent which calls the update method in each observer. When the observer is no longer interested in the subject's state, they can simply detach themselves."*
>  

回顾已公开的、与语言无关的设计模式定义通常会很有用，以便随着时间的流逝而更广泛地了解其用法和优势。GoF(四人帮)的书《设计模式：可重用的面向对象软件的元素》中提供的Observer模式的定义为：

*一个或多个观察者对主题的状态感兴趣，并通过注册自己感兴趣的状态依赖于观察主体。当观察者可能感兴趣的状态发生变化时，观察主体将发送一条通知消息，该消息将在每个观察者中调用update方法。当观察者不再对观察主体的状态更改感兴趣时，它们可以简单地将自己分离。*

> We can now expand on what we've learned to implement the Observer pattern with the following components:

> - **Subject**: maintains a list of observers, facilitates adding or removing observers
> - **Observer**: provides an update interface for objects that need to be notified of a Subject's changes of state
> - **ConcreteSubject**: broadcasts notifications to observers on changes of state, stores the state of ConcreteObservers
> - **ConcreteObserver**: stores a reference to the ConcreteSubject, implements an update interface for the Observer to ensure state is consistent with the Subject's
